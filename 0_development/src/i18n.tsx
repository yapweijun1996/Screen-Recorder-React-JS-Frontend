import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';

export type LanguageCode = 'en' | 'zh' | 'ja' | 'ko' | 'es' | 'fr' | 'de' | 'pt' | 'hi' | 'id';

export interface LanguageOption {
    code: LanguageCode;
    label: string;
}

const LANGUAGE_STORAGE_KEY = 'screenclip.language';
const DEFAULT_LANGUAGE: LanguageCode = 'en';

export const LANGUAGE_OPTIONS: LanguageOption[] = [
    { code: 'en', label: 'English' },
    { code: 'zh', label: '简体中文' },
    { code: 'ja', label: '日本語' },
    { code: 'ko', label: '한국어' },
    { code: 'es', label: 'Español' },
    { code: 'fr', label: 'Français' },
    { code: 'de', label: 'Deutsch' },
    { code: 'pt', label: 'Português' },
    { code: 'hi', label: 'हिन्दी' },
    { code: 'id', label: 'Bahasa Indonesia' },
];

type TranslationTable = Record<string, string>;

const translations: Record<LanguageCode, TranslationTable> = {
    en: {
        'common.language': 'Language',
        'common.processing': 'Processing...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'Client-side MP4 Export',
        'app.footer.line1': 'Built with React, Tailwind & FFmpeg.wasm • by yapweijun1996',
        'app.footer.line2': 'Version 2.0 - Now with Pause, Draggable Camera & Preloaded Export',
        'app.processing.title': 'Finishing your capture...',
        'app.processing.desc': 'We are making sure the recording metadata is sane so playback and trimming behave reliably.',
        'app.error.empty': 'The recording is empty. Please try capturing again and let it run for a few seconds.',
        'app.error.invalidDuration': 'Invalid recording duration detected.',
        'app.error.invalid': 'Recording looks invalid. Please try capturing again.',
        'app.error.finalize': 'Failed to finish processing the recording. Please try again.',

        'ffmpeg.idle': 'Engine Idle',
        'ffmpeg.loading': 'Loading Engine...',
        'ffmpeg.loaded': 'Engine Ready',
        'ffmpeg.error': 'Engine Error',

        'recorder.sidebar.title': 'Capture Setup',
        'recorder.sidebar.subtitle': 'Sources + quality before you start',
        'recorder.sources.title': 'Sources',
        'recorder.sources.hint': 'System audio via screen share',
        'recorder.sources.mic.title': 'Microphone',
        'recorder.sources.mic.on': 'Included in mix',
        'recorder.sources.mic.off': 'Muted',
        'recorder.sources.cam.title': 'Camera PIP',
        'recorder.sources.cam.on': 'Picture-in-picture on',
        'recorder.sources.cam.off': 'Disabled',
        'recorder.sources.cam.position': 'Camera Position',
        'recorder.sources.cam.tooltip': 'Cycle camera position',
        'recorder.sources.cam.pos.bottom-right': 'Bottom right',
        'recorder.sources.cam.pos.bottom-left': 'Bottom left',
        'recorder.sources.cam.pos.top-right': 'Top right',
        'recorder.sources.cam.pos.top-left': 'Top left',
        'recorder.quality.title': 'Quality',
        'recorder.quality.subtitle': 'FPS / Bitrate',
        'recorder.quality.standard.label': 'Standard',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'High',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'Ultra',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'Custom',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'Initializing...',
        'recorder.cta.start': 'Start Recording',
        'recorder.tip': "Tip: choose 'Entire Screen' to capture system audio.",

        'preview.ready.title': 'Ready to Capture',
        'preview.ready.desc': 'Pick your sources and quality on the left, then start recording.',
        'preview.ready.controls': 'Controls will appear here during recording',
        'preview.badge.paused': 'PAUSED',
        'preview.badge.rec': 'REC',
        'preview.resume': 'Resume',
        'preview.pause': 'Pause',
        'preview.changePosition': 'Change camera position',
        'preview.stop': 'Stop',
        'preview.footer.paused': 'Recording paused. Click Resume to continue.',
        'preview.footer.recording': 'Recording in progress.',
        'preview.footer.tip': "Pro Tip: Select 'Entire Screen' to capture system audio.",

        'recorder.errors.empty': 'Recording appears to be empty. Please keep the capture running for a moment before stopping.',
        'recorder.errors.permission': 'Permission denied. Please allow screen sharing to record.',
        'recorder.errors.startFailed': 'Failed to start recording',

        'editor.header.title': 'Edit & Export',
        'editor.header.subtitle': 'Trim your clip, choose export settings, then download.',
        'editor.header.recordNew': 'Record New',

        'editor.player.fullscreen.enter': 'Enter fullscreen',
        'editor.player.fullscreen.exit': 'Exit fullscreen',
        'editor.player.total': 'Total',
        'editor.player.size': 'Size',

        'editor.trim.title': 'Trim',
        'editor.trim.duration': 'Duration',
        'editor.trim.start': 'Start',
        'editor.trim.end': 'End',
        'editor.trim.preview': 'Preview Selection',
        'editor.trim.reset': 'Reset Trim',

        'editor.playback.durationUnknown': 'Recording duration could not be determined. Please record again.',
        'editor.playback.durationZero': 'Recording duration is zero. Please record again.',
        'editor.playback.readError': 'Could not read recording duration. Please record again.',
        'editor.playback.cannotExport': 'Cannot export: recording is empty or corrupted.',
        'editor.playback.trimInvalid': 'Please select a trim range greater than zero.',

        'editor.export.title': 'Export',
        'editor.export.settings': 'Settings',
        'editor.export.quickHint': 'Quick high quality: CRF 20 / 60fps / Original',
        'editor.export.quickButton': 'Apply preset',
        'editor.export.estimated': 'Estimated size',
        'editor.export.quality': 'Quality',
        'editor.export.crf': 'CRF (18-23 recommended)',
        'editor.export.crfHint': 'Lower is clearer, but larger files.',
        'editor.export.resolution': 'Resolution',
        'editor.export.resolutionOriginal': 'Original',
        'editor.export.frameRate': 'Frame Rate',
        'editor.export.frameRateHint': 'Higher frame rates are smoother but slower to process.',
        'editor.export.format': 'Format',
        'editor.export.processing': 'Processing...',
        'editor.export.eta': 'ETA',
        'editor.export.etaEstimating': 'estimating...',
        'editor.export.ready': 'Export ready',
        'editor.export.download': 'Download {{format}}',
        'editor.export.exportAnother': 'Export another version',
        'editor.export.exportTrimmed': 'Export Trimmed ({{label}})',
        'editor.export.exportFull': 'Export Full Video (No Trim)',
        'editor.export.playbackIssue': 'Fix playback issue by recording again.',
        'editor.export.failed': 'Failed to export video. Please check console.',

        'quality.low.label': 'Low (Fast)',
        'quality.low.description': 'Smaller file size, faster processing',
        'quality.medium.label': 'Medium (Balanced)',
        'quality.medium.description': 'Good balance of quality and size',
        'quality.high.label': 'High (Quality)',
        'quality.high.description': 'High quality, larger file size',
        'quality.lossless.label': 'Lossless (Max)',
        'quality.lossless.description': 'Best quality, very large file',
    },
    zh: {
        'common.language': '语言',
        'common.processing': '处理中...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': '本地 MP4 导出',
        'app.footer.line1': '由 React、Tailwind 和 FFmpeg.wasm 构建 • yapweijun1996',
        'app.footer.line2': '2.0 版 - 支持暂停、可拖动摄像头与预加载导出',
        'app.processing.title': '正在完成录制...',
        'app.processing.desc': '我们正在校准录制元数据，确保播放与裁剪稳定。',
        'app.error.empty': '录制内容为空，请重新录制并多录几秒。',
        'app.error.invalidDuration': '检测到无效的录制时长。',
        'app.error.invalid': '录制看起来异常，请重试。',
        'app.error.finalize': '录制处理失败，请重试。',

        'ffmpeg.idle': '引擎空闲',
        'ffmpeg.loading': '正在加载引擎...',
        'ffmpeg.loaded': '引擎就绪',
        'ffmpeg.error': '引擎错误',

        'recorder.sidebar.title': '录制设置',
        'recorder.sidebar.subtitle': '开始前选择来源与质量',
        'recorder.sources.title': '来源',
        'recorder.sources.hint': '通过屏幕共享获取系统音频',
        'recorder.sources.mic.title': '麦克风',
        'recorder.sources.mic.on': '包含在混音中',
        'recorder.sources.mic.off': '已静音',
        'recorder.sources.cam.title': '摄像头画中画',
        'recorder.sources.cam.on': '画中画已开启',
        'recorder.sources.cam.off': '已关闭',
        'recorder.sources.cam.position': '摄像头位置',
        'recorder.sources.cam.tooltip': '循环切换摄像头位置',
        'recorder.sources.cam.pos.bottom-right': '右下角',
        'recorder.sources.cam.pos.bottom-left': '左下角',
        'recorder.sources.cam.pos.top-right': '右上角',
        'recorder.sources.cam.pos.top-left': '左上角',
        'recorder.quality.title': '质量',
        'recorder.quality.subtitle': '帧率 / 码率',
        'recorder.quality.standard.label': '标准',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': '高',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': '超高',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': '自定义',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': '帧率',
        'recorder.custom.mbps': '码率',
        'recorder.cta.initializing': '正在初始化...',
        'recorder.cta.start': '开始录制',
        'recorder.tip': "提示：选择“Entire Screen”可录系统音频。",

        'preview.ready.title': '准备录制',
        'preview.ready.desc': '在左侧选择来源和质量，然后开始录制。',
        'preview.ready.controls': '录制时此处会出现控制栏',
        'preview.badge.paused': '已暂停',
        'preview.badge.rec': '录制中',
        'preview.resume': '继续',
        'preview.pause': '暂停',
        'preview.changePosition': '切换摄像头位置',
        'preview.stop': '停止',
        'preview.footer.paused': '录制已暂停，点击继续即可恢复。',
        'preview.footer.recording': '正在录制。',
        'preview.footer.tip': "小贴士：选择“Entire Screen”可以录到系统音频。",

        'recorder.errors.empty': '录制为空，请稍等片刻再停止。',
        'recorder.errors.permission': '权限被拒绝，请允许屏幕共享后再试。',
        'recorder.errors.startFailed': '启动录制失败',

        'editor.header.title': '剪辑与导出',
        'editor.header.subtitle': '裁剪片段，调整导出设置并下载。',
        'editor.header.recordNew': '重新录制',

        'editor.player.fullscreen.enter': '进入全屏',
        'editor.player.fullscreen.exit': '退出全屏',
        'editor.player.total': '总时长',
        'editor.player.size': '大小',

        'editor.trim.title': '裁剪',
        'editor.trim.duration': '时长',
        'editor.trim.start': '开始',
        'editor.trim.end': '结束',
        'editor.trim.preview': '预览所选片段',
        'editor.trim.reset': '重置裁剪',

        'editor.playback.durationUnknown': '无法确定录制时长，请重新录制。',
        'editor.playback.durationZero': '录制时长为 0，请重新录制。',
        'editor.playback.readError': '无法读取录制时长，请重新录制。',
        'editor.playback.cannotExport': '无法导出：录制为空或已损坏。',
        'editor.playback.trimInvalid': '请选择大于零的裁剪区间。',

        'editor.export.title': '导出',
        'editor.export.settings': '设置',
        'editor.export.quickHint': '高质快捷：CRF 20 / 60fps / 原始分辨率',
        'editor.export.quickButton': '一键应用',
        'editor.export.estimated': '预计大小',
        'editor.export.quality': '质量',
        'editor.export.crf': 'CRF（18-23 推荐）',
        'editor.export.crfHint': '数值越低越清晰，文件越大。',
        'editor.export.resolution': '分辨率',
        'editor.export.resolutionOriginal': '原始分辨率',
        'editor.export.frameRate': '帧率',
        'editor.export.frameRateHint': '更高帧率更流畅，但处理更慢。',
        'editor.export.format': '格式',
        'editor.export.processing': '正在处理...',
        'editor.export.eta': '预计剩余',
        'editor.export.etaEstimating': '估算中...',
        'editor.export.ready': '导出就绪',
        'editor.export.download': '下载 {{format}}',
        'editor.export.exportAnother': '导出其他版本',
        'editor.export.exportTrimmed': '导出裁剪片段（{{label}}）',
        'editor.export.exportFull': '导出完整视频（不裁剪）',
        'editor.export.playbackIssue': '请重新录制以修复播放问题。',
        'editor.export.failed': '导出失败，请查看控制台。',

        'quality.low.label': '低（快速）',
        'quality.low.description': '文件更小，处理更快',
        'quality.medium.label': '中（均衡）',
        'quality.medium.description': '质量与体积的平衡',
        'quality.high.label': '高（清晰）',
        'quality.high.description': '更高质量，更大文件',
        'quality.lossless.label': '无损（最大）',
        'quality.lossless.description': '最高质量，体积很大',
    },
    ja: {
        'common.language': '言語',
        'common.processing': '処理中...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'クライアント側 MP4 書き出し',
        'app.footer.line1': 'React・Tailwind・FFmpeg.wasm で構築 • yapweijun1996',
        'app.footer.line2': 'バージョン 2.0 - 一時停止、ドラッグ可能カメラ、事前ロード導出',
        'app.processing.title': '録画を仕上げています...',
        'app.processing.desc': '再生とトリミングが安定するようメタデータを整えています。',
        'app.error.empty': '録画が空です。数秒間録画してから停止してください。',
        'app.error.invalidDuration': '無効な録画時間を検出しました。',
        'app.error.invalid': '録画に問題があります。もう一度お試しください。',
        'app.error.finalize': '録画の処理に失敗しました。再試行してください。',

        'ffmpeg.idle': 'エンジン待機中',
        'ffmpeg.loading': 'エンジン読込中...',
        'ffmpeg.loaded': 'エンジン準備完了',
        'ffmpeg.error': 'エンジンエラー',

        'recorder.sidebar.title': 'キャプチャ設定',
        'recorder.sidebar.subtitle': '開始前にソースと品質を選択',
        'recorder.sources.title': 'ソース',
        'recorder.sources.hint': '画面共有でシステム音声を取得',
        'recorder.sources.mic.title': 'マイク',
        'recorder.sources.mic.on': 'ミックスに含める',
        'recorder.sources.mic.off': 'ミュート',
        'recorder.sources.cam.title': 'カメラ PIP',
        'recorder.sources.cam.on': 'ピクチャインピクチャ ON',
        'recorder.sources.cam.off': '無効',
        'recorder.sources.cam.position': 'カメラ位置',
        'recorder.sources.cam.tooltip': 'カメラ位置を切り替え',
        'recorder.sources.cam.pos.bottom-right': '右下',
        'recorder.sources.cam.pos.bottom-left': '左下',
        'recorder.sources.cam.pos.top-right': '右上',
        'recorder.sources.cam.pos.top-left': '左上',
        'recorder.quality.title': '品質',
        'recorder.quality.subtitle': 'FPS / ビットレート',
        'recorder.quality.standard.label': '標準',
        'recorder.quality.standard.detail': '30fps • 約5Mbps',
        'recorder.quality.high.label': '高',
        'recorder.quality.high.detail': '30fps • 約10Mbps',
        'recorder.quality.ultra.label': 'ウルトラ',
        'recorder.quality.ultra.detail': '60fps • 約20Mbps',
        'recorder.quality.custom.label': 'カスタム',
        'recorder.quality.custom.detail': '{{fps}}fps • 約{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': '初期化中...',
        'recorder.cta.start': '録画開始',
        'recorder.tip': "ヒント：「Entire Screen」を選ぶとシステム音声を録音できます。",

        'preview.ready.title': '録画の準備完了',
        'preview.ready.desc': '左でソースと品質を選び、録画を開始してください。',
        'preview.ready.controls': '録画中はここにコントロールが表示されます',
        'preview.badge.paused': '一時停止',
        'preview.badge.rec': '録画中',
        'preview.resume': '再開',
        'preview.pause': '一時停止',
        'preview.changePosition': 'カメラ位置を変更',
        'preview.stop': '停止',
        'preview.footer.paused': '録画を一時停止中です。再開をクリックしてください。',
        'preview.footer.recording': '録画中です。',
        'preview.footer.tip': "ヒント：「Entire Screen」を選ぶとシステム音声を取得できます。",

        'recorder.errors.empty': '録画が空です。少し長めに録画してから停止してください。',
        'recorder.errors.permission': '許可が必要です。画面共有を許可してください。',
        'recorder.errors.startFailed': '録画の開始に失敗しました',

        'editor.header.title': '編集と書き出し',
        'editor.header.subtitle': 'クリップをトリミングし、設定してダウンロード。',
        'editor.header.recordNew': '再録画',

        'editor.player.fullscreen.enter': '全画面表示',
        'editor.player.fullscreen.exit': '全画面を終了',
        'editor.player.total': '合計',
        'editor.player.size': 'サイズ',

        'editor.trim.title': 'トリム',
        'editor.trim.duration': '長さ',
        'editor.trim.start': '開始',
        'editor.trim.end': '終了',
        'editor.trim.preview': '選択範囲をプレビュー',
        'editor.trim.reset': 'トリムをリセット',

        'editor.playback.durationUnknown': '録画時間を取得できません。再録画してください。',
        'editor.playback.durationZero': '録画時間が 0 秒です。再録画してください。',
        'editor.playback.readError': '録画時間を読み取れません。再録画してください。',
        'editor.playback.cannotExport': '書き出せません：録画が空または破損しています。',
        'editor.playback.trimInvalid': '0 より大きい範囲を選択してください。',

        'editor.export.title': '書き出し',
        'editor.export.settings': '設定',
        'editor.export.quickHint': '高品質クイック：CRF 20 / 60fps / 元解像度',
        'editor.export.quickButton': 'プリセット適用',
        'editor.export.estimated': '予想サイズ',
        'editor.export.quality': '品質',
        'editor.export.crf': 'CRF (18-23 推奨)',
        'editor.export.crfHint': '数値が低いほど高画質ですが、サイズが大きくなります。',
        'editor.export.resolution': '解像度',
        'editor.export.resolutionOriginal': 'オリジナル',
        'editor.export.frameRate': 'フレームレート',
        'editor.export.frameRateHint': 'フレームレートが高いほど滑らかですが、処理が遅くなります。',
        'editor.export.format': '形式',
        'editor.export.processing': '処理中...',
        'editor.export.eta': '残り時間',
        'editor.export.etaEstimating': '計算中...',
        'editor.export.ready': '書き出し完了',
        'editor.export.download': '{{format}} をダウンロード',
        'editor.export.exportAnother': '別のバージョンを出力',
        'editor.export.exportTrimmed': 'トリムを出力（{{label}}）',
        'editor.export.exportFull': '全編を出力（トリムなし）',
        'editor.export.playbackIssue': '再録画して再生問題を修正してください。',
        'editor.export.failed': '書き出しに失敗しました。コンソールを確認してください。',

        'quality.low.label': '低 (高速)',
        'quality.low.description': '小さいサイズ、処理が速い',
        'quality.medium.label': '中 (バランス)',
        'quality.medium.description': '品質とサイズのバランス',
        'quality.high.label': '高 (高画質)',
        'quality.high.description': '高品質、サイズ増',
        'quality.lossless.label': 'ロスレス (最大)',
        'quality.lossless.description': '最高品質、とても大きいサイズ',
    },
    ko: {
        'common.language': '언어',
        'common.processing': '처리 중...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': '클라이언트 MP4 내보내기',
        'app.footer.line1': 'React, Tailwind, FFmpeg.wasm 기반 • yapweijun1996',
        'app.footer.line2': '버전 2.0 - 일시정지, 드래그 카메라, 사전 로드 내보내기',
        'app.processing.title': '캡처를 마무리하는 중...',
        'app.processing.desc': '재생과 트리밍이 안정되도록 메타데이터를 정리하고 있습니다.',
        'app.error.empty': '녹화가 비어 있습니다. 몇 초 더 녹화한 후 다시 시도하세요.',
        'app.error.invalidDuration': '잘못된 녹화 길이가 감지되었습니다.',
        'app.error.invalid': '녹화에 문제가 있습니다. 다시 시도하세요.',
        'app.error.finalize': '녹화 처리에 실패했습니다. 다시 시도하세요.',

        'ffmpeg.idle': '엔진 대기',
        'ffmpeg.loading': '엔진 불러오는 중...',
        'ffmpeg.loaded': '엔진 준비 완료',
        'ffmpeg.error': '엔진 오류',

        'recorder.sidebar.title': '캡처 설정',
        'recorder.sidebar.subtitle': '시작 전 소스와 품질 선택',
        'recorder.sources.title': '소스',
        'recorder.sources.hint': '화면 공유로 시스템 오디오 수집',
        'recorder.sources.mic.title': '마이크',
        'recorder.sources.mic.on': '믹스에 포함',
        'recorder.sources.mic.off': '음소거',
        'recorder.sources.cam.title': '카메라 PIP',
        'recorder.sources.cam.on': 'PIP 켜짐',
        'recorder.sources.cam.off': '비활성화',
        'recorder.sources.cam.position': '카메라 위치',
        'recorder.sources.cam.tooltip': '카메라 위치 순환',
        'recorder.sources.cam.pos.bottom-right': '오른쪽 아래',
        'recorder.sources.cam.pos.bottom-left': '왼쪽 아래',
        'recorder.sources.cam.pos.top-right': '오른쪽 위',
        'recorder.sources.cam.pos.top-left': '왼쪽 위',
        'recorder.quality.title': '품질',
        'recorder.quality.subtitle': 'FPS / 비트레이트',
        'recorder.quality.standard.label': '표준',
        'recorder.quality.standard.detail': '30fps • 약 5Mbps',
        'recorder.quality.high.label': '높음',
        'recorder.quality.high.detail': '30fps • 약 10Mbps',
        'recorder.quality.ultra.label': '울트라',
        'recorder.quality.ultra.detail': '60fps • 약 20Mbps',
        'recorder.quality.custom.label': '사용자 지정',
        'recorder.quality.custom.detail': '{{fps}}fps • 약 {{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': '초기화 중...',
        'recorder.cta.start': '녹화 시작',
        'recorder.tip': "팁: 'Entire Screen'을 선택하면 시스템 오디오를 녹음합니다.",

        'preview.ready.title': '녹화 준비 완료',
        'preview.ready.desc': '왼쪽에서 소스와 품질을 고른 뒤 녹화를 시작하세요.',
        'preview.ready.controls': '녹화 중 여기에서 제어할 수 있습니다',
        'preview.badge.paused': '일시정지',
        'preview.badge.rec': '녹화중',
        'preview.resume': '재개',
        'preview.pause': '일시정지',
        'preview.changePosition': '카메라 위치 변경',
        'preview.stop': '정지',
        'preview.footer.paused': '녹화가 일시정지되었습니다. 재개를 누르세요.',
        'preview.footer.recording': '녹화 중입니다.',
        'preview.footer.tip': "팁: 'Entire Screen'을 선택하면 시스템 오디오를 캡처합니다.",

        'recorder.errors.empty': '녹화가 비어 있습니다. 잠시 더 녹화한 뒤 정지하세요.',
        'recorder.errors.permission': '권한 거부됨. 화면 공유를 허용하세요.',
        'recorder.errors.startFailed': '녹화를 시작하지 못했습니다',

        'editor.header.title': '편집 및 내보내기',
        'editor.header.subtitle': '클립을 다듬고 설정 후 다운로드하세요.',
        'editor.header.recordNew': '다시 녹화',

        'editor.player.fullscreen.enter': '전체 화면',
        'editor.player.fullscreen.exit': '전체 화면 종료',
        'editor.player.total': '전체',
        'editor.player.size': '크기',

        'editor.trim.title': '트림',
        'editor.trim.duration': '길이',
        'editor.trim.start': '시작',
        'editor.trim.end': '끝',
        'editor.trim.preview': '선택 영역 미리보기',
        'editor.trim.reset': '트림 초기화',

        'editor.playback.durationUnknown': '녹화 길이를 확인할 수 없습니다. 다시 녹화하세요.',
        'editor.playback.durationZero': '녹화 길이가 0초입니다. 다시 녹화하세요.',
        'editor.playback.readError': '녹화 길이를 읽을 수 없습니다. 다시 녹화하세요.',
        'editor.playback.cannotExport': '내보낼 수 없습니다: 녹화가 비었거나 손상되었습니다.',
        'editor.playback.trimInvalid': '0보다 큰 트림 구간을 선택하세요.',

        'editor.export.title': '내보내기',
        'editor.export.settings': '설정',
        'editor.export.quickHint': '고품질 빠른 설정: CRF 20 / 60fps / 원본 해상도',
        'editor.export.quickButton': '프리셋 적용',
        'editor.export.estimated': '예상 크기',
        'editor.export.quality': '품질',
        'editor.export.crf': 'CRF (18-23 권장)',
        'editor.export.crfHint': '값이 낮을수록 선명하지만 용량이 커집니다.',
        'editor.export.resolution': '해상도',
        'editor.export.resolutionOriginal': '원본',
        'editor.export.frameRate': '프레임 레이트',
        'editor.export.frameRateHint': '프레임이 높을수록 부드럽지만 처리 시간이 길어집니다.',
        'editor.export.format': '형식',
        'editor.export.processing': '처리 중...',
        'editor.export.eta': '남은 시간',
        'editor.export.etaEstimating': '계산 중...',
        'editor.export.ready': '내보내기 준비 완료',
        'editor.export.download': '{{format}} 다운로드',
        'editor.export.exportAnother': '다른 버전 내보내기',
        'editor.export.exportTrimmed': '트림된 부분 내보내기 ({{label}})',
        'editor.export.exportFull': '전체 영상 내보내기 (트림 없음)',
        'editor.export.playbackIssue': '재녹화하여 재생 문제를 해결하세요.',
        'editor.export.failed': '내보내기에 실패했습니다. 콘솔을 확인하세요.',

        'quality.low.label': '낮음 (빠름)',
        'quality.low.description': '파일이 작고 처리 속도가 빠름',
        'quality.medium.label': '중간 (균형)',
        'quality.medium.description': '품질과 크기의 균형',
        'quality.high.label': '높음 (고화질)',
        'quality.high.description': '고화질, 큰 용량',
        'quality.lossless.label': '무손실 (최대)',
        'quality.lossless.description': '최고 화질, 매우 큰 용량',
    },
    es: {
        'common.language': 'Idioma',
        'common.processing': 'Procesando...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'Exportación MP4 en el navegador',
        'app.footer.line1': 'Creado con React, Tailwind y FFmpeg.wasm • yapweijun1996',
        'app.footer.line2': 'Versión 2.0 - Pausa, cámara flotante y exportación precargada',
        'app.processing.title': 'Terminando tu captura...',
        'app.processing.desc': 'Ajustamos los metadatos para que la reproducción y el recorte sean estables.',
        'app.error.empty': 'La grabación está vacía. Intenta grabar unos segundos más.',
        'app.error.invalidDuration': 'Se detectó una duración de grabación no válida.',
        'app.error.invalid': 'La grabación parece inválida. Vuelve a intentarlo.',
        'app.error.finalize': 'No se pudo procesar la grabación. Vuelve a intentarlo.',

        'ffmpeg.idle': 'Motor inactivo',
        'ffmpeg.loading': 'Cargando motor...',
        'ffmpeg.loaded': 'Motor listo',
        'ffmpeg.error': 'Error del motor',

        'recorder.sidebar.title': 'Configuración de captura',
        'recorder.sidebar.subtitle': 'Fuentes y calidad antes de empezar',
        'recorder.sources.title': 'Fuentes',
        'recorder.sources.hint': 'Audio del sistema vía compartir pantalla',
        'recorder.sources.mic.title': 'Micrófono',
        'recorder.sources.mic.on': 'Incluido en la mezcla',
        'recorder.sources.mic.off': 'Silenciado',
        'recorder.sources.cam.title': 'Cámara PIP',
        'recorder.sources.cam.on': 'PIP activado',
        'recorder.sources.cam.off': 'Desactivado',
        'recorder.sources.cam.position': 'Posición de cámara',
        'recorder.sources.cam.tooltip': 'Cambiar posición de la cámara',
        'recorder.sources.cam.pos.bottom-right': 'Inferior derecha',
        'recorder.sources.cam.pos.bottom-left': 'Inferior izquierda',
        'recorder.sources.cam.pos.top-right': 'Superior derecha',
        'recorder.sources.cam.pos.top-left': 'Superior izquierda',
        'recorder.quality.title': 'Calidad',
        'recorder.quality.subtitle': 'FPS / Bitrate',
        'recorder.quality.standard.label': 'Estándar',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'Alta',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'Ultra',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'Personalizada',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'Inicializando...',
        'recorder.cta.start': 'Comenzar grabación',
        'recorder.tip': "Consejo: elige 'Entire Screen' para capturar el audio del sistema.",

        'preview.ready.title': 'Listo para grabar',
        'preview.ready.desc': 'Elige fuentes y calidad a la izquierda y empieza a grabar.',
        'preview.ready.controls': 'Los controles aparecerán aquí durante la grabación',
        'preview.badge.paused': 'PAUSADO',
        'preview.badge.rec': 'GRAB',
        'preview.resume': 'Reanudar',
        'preview.pause': 'Pausa',
        'preview.changePosition': 'Cambiar posición de la cámara',
        'preview.stop': 'Detener',
        'preview.footer.paused': 'Grabación en pausa. Pulsa Reanudar para continuar.',
        'preview.footer.recording': 'Grabando en curso.',
        'preview.footer.tip': "Consejo: selecciona 'Entire Screen' para capturar el audio del sistema.",

        'recorder.errors.empty': 'La grabación está vacía. Graba un poco más antes de detener.',
        'recorder.errors.permission': 'Permiso denegado. Habilita el uso compartido de pantalla.',
        'recorder.errors.startFailed': 'No se pudo iniciar la grabación',

        'editor.header.title': 'Editar y exportar',
        'editor.header.subtitle': 'Recorta, ajusta la exportación y descarga.',
        'editor.header.recordNew': 'Grabar de nuevo',

        'editor.player.fullscreen.enter': 'Entrar en pantalla completa',
        'editor.player.fullscreen.exit': 'Salir de pantalla completa',
        'editor.player.total': 'Total',
        'editor.player.size': 'Tamaño',

        'editor.trim.title': 'Recorte',
        'editor.trim.duration': 'Duración',
        'editor.trim.start': 'Inicio',
        'editor.trim.end': 'Fin',
        'editor.trim.preview': 'Previsualizar selección',
        'editor.trim.reset': 'Restablecer recorte',

        'editor.playback.durationUnknown': 'No se pudo determinar la duración. Graba de nuevo.',
        'editor.playback.durationZero': 'La duración es cero. Graba de nuevo.',
        'editor.playback.readError': 'No se pudo leer la duración. Graba de nuevo.',
        'editor.playback.cannotExport': 'No se puede exportar: grabación vacía o dañada.',
        'editor.playback.trimInvalid': 'Selecciona un rango de recorte mayor que cero.',

        'editor.export.title': 'Exportar',
        'editor.export.settings': 'Configuración',
        'editor.export.quickHint': 'Alta calidad rápida: CRF 20 / 60fps / Original',
        'editor.export.quickButton': 'Aplicar preset',
        'editor.export.estimated': 'Tamaño estimado',
        'editor.export.quality': 'Calidad',
        'editor.export.crf': 'CRF (18-23 recomendado)',
        'editor.export.crfHint': 'Más bajo = más calidad, archivos más grandes.',
        'editor.export.resolution': 'Resolución',
        'editor.export.resolutionOriginal': 'Original',
        'editor.export.frameRate': 'Fotogramas por segundo',
        'editor.export.frameRateHint': 'Más FPS es más fluido pero más lento de procesar.',
        'editor.export.format': 'Formato',
        'editor.export.processing': 'Procesando...',
        'editor.export.eta': 'ETA',
        'editor.export.etaEstimating': 'estimando...',
        'editor.export.ready': 'Exportación lista',
        'editor.export.download': 'Descargar {{format}}',
        'editor.export.exportAnother': 'Exportar otra versión',
        'editor.export.exportTrimmed': 'Exportar recorte ({{label}})',
        'editor.export.exportFull': 'Exportar video completo (sin recorte)',
        'editor.export.playbackIssue': 'Vuelve a grabar para corregir la reproducción.',
        'editor.export.failed': 'Error al exportar. Revisa la consola.',

        'quality.low.label': 'Baja (Rápida)',
        'quality.low.description': 'Archivo pequeño, procesamiento rápido',
        'quality.medium.label': 'Media (Equilibrada)',
        'quality.medium.description': 'Buen equilibrio de calidad y tamaño',
        'quality.high.label': 'Alta (Calidad)',
        'quality.high.description': 'Alta calidad, archivo más grande',
        'quality.lossless.label': 'Sin pérdida (Máx)',
        'quality.lossless.description': 'Máxima calidad, archivo muy grande',
    },
    fr: {
        'common.language': 'Langue',
        'common.processing': 'Traitement...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'Export MP4 côté client',
        'app.footer.line1': 'Construit avec React, Tailwind et FFmpeg.wasm • yapweijun1996',
        'app.footer.line2': 'Version 2.0 - Pause, caméra déplaçable et export préchargé',
        'app.processing.title': 'Finalisation de votre capture...',
        'app.processing.desc': 'Nous ajustons les métadonnées pour une lecture et un découpage stables.',
        'app.error.empty': 'L’enregistrement est vide. Merci de réessayer en laissant tourner quelques secondes.',
        'app.error.invalidDuration': 'Durée d’enregistrement invalide détectée.',
        'app.error.invalid': 'L’enregistrement semble invalide. Réessayez.',
        'app.error.finalize': 'Échec du traitement de l’enregistrement. Réessayez.',

        'ffmpeg.idle': 'Moteur inactif',
        'ffmpeg.loading': 'Chargement du moteur...',
        'ffmpeg.loaded': 'Moteur prêt',
        'ffmpeg.error': 'Erreur du moteur',

        'recorder.sidebar.title': 'Configuration de capture',
        'recorder.sidebar.subtitle': 'Sources et qualité avant de démarrer',
        'recorder.sources.title': 'Sources',
        'recorder.sources.hint': 'Audio système via partage d’écran',
        'recorder.sources.mic.title': 'Micro',
        'recorder.sources.mic.on': 'Inclus dans le mix',
        'recorder.sources.mic.off': 'Coupé',
        'recorder.sources.cam.title': 'Caméra PIP',
        'recorder.sources.cam.on': 'PIP activé',
        'recorder.sources.cam.off': 'Désactivé',
        'recorder.sources.cam.position': 'Position de la caméra',
        'recorder.sources.cam.tooltip': 'Changer la position de la caméra',
        'recorder.sources.cam.pos.bottom-right': 'Bas droite',
        'recorder.sources.cam.pos.bottom-left': 'Bas gauche',
        'recorder.sources.cam.pos.top-right': 'Haut droite',
        'recorder.sources.cam.pos.top-left': 'Haut gauche',
        'recorder.quality.title': 'Qualité',
        'recorder.quality.subtitle': 'FPS / Débit',
        'recorder.quality.standard.label': 'Standard',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'Élevée',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'Ultra',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'Personnalisée',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'Initialisation...',
        'recorder.cta.start': 'Commencer l’enregistrement',
        'recorder.tip': "Astuce : choisissez 'Entire Screen' pour capter l’audio système.",

        'preview.ready.title': 'Prêt à capturer',
        'preview.ready.desc': 'Choisissez vos sources et la qualité à gauche, puis lancez.',
        'preview.ready.controls': 'Les contrôles apparaîtront ici pendant l’enregistrement',
        'preview.badge.paused': 'PAUSE',
        'preview.badge.rec': 'REC',
        'preview.resume': 'Reprendre',
        'preview.pause': 'Pause',
        'preview.changePosition': 'Changer la position de la caméra',
        'preview.stop': 'Arrêter',
        'preview.footer.paused': 'Enregistrement en pause. Cliquez sur Reprendre pour continuer.',
        'preview.footer.recording': 'Enregistrement en cours.',
        'preview.footer.tip': "Astuce : sélectionnez 'Entire Screen' pour capter l’audio système.",

        'recorder.errors.empty': 'Enregistrement vide. Laissez tourner un peu plus avant d’arrêter.',
        'recorder.errors.permission': 'Permission refusée. Autorisez le partage d’écran.',
        'recorder.errors.startFailed': 'Impossible de démarrer l’enregistrement',

        'editor.header.title': 'Éditer et exporter',
        'editor.header.subtitle': 'Découpez, ajustez l’export puis téléchargez.',
        'editor.header.recordNew': 'Réenregistrer',

        'editor.player.fullscreen.enter': 'Plein écran',
        'editor.player.fullscreen.exit': 'Quitter le plein écran',
        'editor.player.total': 'Total',
        'editor.player.size': 'Taille',

        'editor.trim.title': 'Découpe',
        'editor.trim.duration': 'Durée',
        'editor.trim.start': 'Début',
        'editor.trim.end': 'Fin',
        'editor.trim.preview': 'Prévisualiser la sélection',
        'editor.trim.reset': 'Réinitialiser',

        'editor.playback.durationUnknown': 'Durée introuvable. Veuillez réenregistrer.',
        'editor.playback.durationZero': 'Durée égale à zéro. Veuillez réenregistrer.',
        'editor.playback.readError': 'Impossible de lire la durée. Veuillez réenregistrer.',
        'editor.playback.cannotExport': 'Export impossible : enregistrement vide ou corrompu.',
        'editor.playback.trimInvalid': 'Sélectionnez une plage de découpe supérieure à zéro.',

        'editor.export.title': 'Export',
        'editor.export.settings': 'Paramètres',
        'editor.export.quickHint': 'Haute qualité rapide : CRF 20 / 60fps / Original',
        'editor.export.quickButton': 'Appliquer le preset',
        'editor.export.estimated': 'Taille estimée',
        'editor.export.quality': 'Qualité',
        'editor.export.crf': 'CRF (18-23 recommandé)',
        'editor.export.crfHint': 'Plus bas = plus net, fichiers plus lourds.',
        'editor.export.resolution': 'Résolution',
        'editor.export.resolutionOriginal': 'Original',
        'editor.export.frameRate': 'Fréquence',
        'editor.export.frameRateHint': 'Plus de FPS = plus fluide mais plus lent à traiter.',
        'editor.export.format': 'Format',
        'editor.export.processing': 'Traitement...',
        'editor.export.eta': 'Reste',
        'editor.export.etaEstimating': 'estimation...',
        'editor.export.ready': 'Export prêt',
        'editor.export.download': 'Télécharger {{format}}',
        'editor.export.exportAnother': 'Exporter une autre version',
        'editor.export.exportTrimmed': 'Exporter la découpe ({{label}})',
        'editor.export.exportFull': 'Exporter la vidéo complète (sans découpe)',
        'editor.export.playbackIssue': 'Réenregistrez pour corriger la lecture.',
        'editor.export.failed': 'Échec de l’export. Consultez la console.',

        'quality.low.label': 'Basse (Rapide)',
        'quality.low.description': 'Fichier plus petit, traitement rapide',
        'quality.medium.label': 'Moyenne (Équilibrée)',
        'quality.medium.description': 'Bon équilibre qualité/taille',
        'quality.high.label': 'Haute (Qualité)',
        'quality.high.description': 'Haute qualité, fichier plus gros',
        'quality.lossless.label': 'Sans perte (Max)',
        'quality.lossless.description': 'Qualité maximale, très volumineux',
    },
    de: {
        'common.language': 'Sprache',
        'common.processing': 'Verarbeitung...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'MP4-Export im Browser',
        'app.footer.line1': 'Gebaut mit React, Tailwind & FFmpeg.wasm • yapweijun1996',
        'app.footer.line2': 'Version 2.0 - Pause, bewegliche Kamera & vorab geladener Export',
        'app.processing.title': 'Aufnahme wird abgeschlossen...',
        'app.processing.desc': 'Wir bereinigen die Metadaten, damit Wiedergabe und Schnitt stabil sind.',
        'app.error.empty': 'Die Aufnahme ist leer. Bitte noch ein paar Sekunden aufnehmen.',
        'app.error.invalidDuration': 'Ungültige Aufnahmedauer erkannt.',
        'app.error.invalid': 'Die Aufnahme scheint ungültig. Bitte erneut versuchen.',
        'app.error.finalize': 'Aufnahme konnte nicht verarbeitet werden. Bitte erneut versuchen.',

        'ffmpeg.idle': 'Engine inaktiv',
        'ffmpeg.loading': 'Engine wird geladen...',
        'ffmpeg.loaded': 'Engine bereit',
        'ffmpeg.error': 'Engine-Fehler',

        'recorder.sidebar.title': 'Aufnahme-Setup',
        'recorder.sidebar.subtitle': 'Quellen & Qualität vor dem Start',
        'recorder.sources.title': 'Quellen',
        'recorder.sources.hint': 'Systemaudio über Bildschirmfreigabe',
        'recorder.sources.mic.title': 'Mikrofon',
        'recorder.sources.mic.on': 'Im Mix enthalten',
        'recorder.sources.mic.off': 'Stumm',
        'recorder.sources.cam.title': 'Kamera PIP',
        'recorder.sources.cam.on': 'Bild-in-Bild an',
        'recorder.sources.cam.off': 'Deaktiviert',
        'recorder.sources.cam.position': 'Kameraposition',
        'recorder.sources.cam.tooltip': 'Kameraposition wechseln',
        'recorder.sources.cam.pos.bottom-right': 'Unten rechts',
        'recorder.sources.cam.pos.bottom-left': 'Unten links',
        'recorder.sources.cam.pos.top-right': 'Oben rechts',
        'recorder.sources.cam.pos.top-left': 'Oben links',
        'recorder.quality.title': 'Qualität',
        'recorder.quality.subtitle': 'FPS / Bitrate',
        'recorder.quality.standard.label': 'Standard',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'Hoch',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'Ultra',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'Benutzerdefiniert',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'Initialisiere...',
        'recorder.cta.start': 'Aufnahme starten',
        'recorder.tip': "Tipp: Wähle 'Entire Screen', um Systemaudio aufzunehmen.",

        'preview.ready.title': 'Bereit zum Aufnehmen',
        'preview.ready.desc': 'Wähle links Quellen und Qualität und starte dann die Aufnahme.',
        'preview.ready.controls': 'Kontrollen erscheinen hier während der Aufnahme',
        'preview.badge.paused': 'PAUSE',
        'preview.badge.rec': 'REC',
        'preview.resume': 'Fortsetzen',
        'preview.pause': 'Pause',
        'preview.changePosition': 'Kameraposition ändern',
        'preview.stop': 'Stopp',
        'preview.footer.paused': 'Aufnahme pausiert. Zum Fortsetzen klicken.',
        'preview.footer.recording': 'Aufnahme läuft.',
        'preview.footer.tip': "Tipp: Wähle 'Entire Screen', um Systemaudio zu erfassen.",

        'recorder.errors.empty': 'Aufnahme ist leer. Nimm etwas länger auf, bevor du stoppst.',
        'recorder.errors.permission': 'Erlaubnis verweigert. Bildschirmfreigabe erlauben.',
        'recorder.errors.startFailed': 'Aufnahme konnte nicht gestartet werden',

        'editor.header.title': 'Schneiden & Exportieren',
        'editor.header.subtitle': 'Clip trimmen, Export einstellen und herunterladen.',
        'editor.header.recordNew': 'Neu aufnehmen',

        'editor.player.fullscreen.enter': 'Vollbild',
        'editor.player.fullscreen.exit': 'Vollbild verlassen',
        'editor.player.total': 'Gesamt',
        'editor.player.size': 'Größe',

        'editor.trim.title': 'Trimmen',
        'editor.trim.duration': 'Dauer',
        'editor.trim.start': 'Start',
        'editor.trim.end': 'Ende',
        'editor.trim.preview': 'Auswahl ansehen',
        'editor.trim.reset': 'Trimmen zurücksetzen',

        'editor.playback.durationUnknown': 'Dauer konnte nicht ermittelt werden. Bitte neu aufnehmen.',
        'editor.playback.durationZero': 'Dauer ist 0. Bitte neu aufnehmen.',
        'editor.playback.readError': 'Dauer konnte nicht gelesen werden. Bitte neu aufnehmen.',
        'editor.playback.cannotExport': 'Export nicht möglich: Aufnahme leer oder beschädigt.',
        'editor.playback.trimInvalid': 'Bitte einen Bereich größer als Null wählen.',

        'editor.export.title': 'Export',
        'editor.export.settings': 'Einstellungen',
        'editor.export.quickHint': 'Schnell hohe Qualität: CRF 20 / 60fps / Original',
        'editor.export.quickButton': 'Preset anwenden',
        'editor.export.estimated': 'Geschätzte Größe',
        'editor.export.quality': 'Qualität',
        'editor.export.crf': 'CRF (18-23 empfohlen)',
        'editor.export.crfHint': 'Niedriger = besser, aber größer.',
        'editor.export.resolution': 'Auflösung',
        'editor.export.resolutionOriginal': 'Original',
        'editor.export.frameRate': 'Bildrate',
        'editor.export.frameRateHint': 'Höhere Bildrate ist flüssiger, braucht aber länger.',
        'editor.export.format': 'Format',
        'editor.export.processing': 'Verarbeite...',
        'editor.export.eta': 'Restzeit',
        'editor.export.etaEstimating': 'Berechne...',
        'editor.export.ready': 'Export fertig',
        'editor.export.download': '{{format}} herunterladen',
        'editor.export.exportAnother': 'Weitere Version exportieren',
        'editor.export.exportTrimmed': 'Getrimmten Teil exportieren ({{label}})',
        'editor.export.exportFull': 'Gesamtes Video exportieren (ohne Trim)',
        'editor.export.playbackIssue': 'Neu aufnehmen, um Wiedergabe zu reparieren.',
        'editor.export.failed': 'Export fehlgeschlagen. Konsole prüfen.',

        'quality.low.label': 'Niedrig (Schnell)',
        'quality.low.description': 'Kleiner, schnell verarbeitet',
        'quality.medium.label': 'Mittel (Ausgewogen)',
        'quality.medium.description': 'Gleichgewicht aus Qualität und Größe',
        'quality.high.label': 'Hoch (Qualität)',
        'quality.high.description': 'Hohe Qualität, größere Dateien',
        'quality.lossless.label': 'Verlustfrei (Max)',
        'quality.lossless.description': 'Beste Qualität, sehr groß',
    },
    pt: {
        'common.language': 'Idioma',
        'common.processing': 'Processando...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'Exportação MP4 no navegador',
        'app.footer.line1': 'Feito com React, Tailwind e FFmpeg.wasm • yapweijun1996',
        'app.footer.line2': 'Versão 2.0 - Pausa, câmera móvel e export pré-carregado',
        'app.processing.title': 'Finalizando sua captura...',
        'app.processing.desc': 'Ajustamos os metadados para reprodução e corte confiáveis.',
        'app.error.empty': 'A gravação está vazia. Grave por alguns segundos a mais e tente novamente.',
        'app.error.invalidDuration': 'Duração inválida detectada.',
        'app.error.invalid': 'A gravação parece inválida. Tente novamente.',
        'app.error.finalize': 'Falha ao processar a gravação. Tente novamente.',

        'ffmpeg.idle': 'Motor inativo',
        'ffmpeg.loading': 'Carregando motor...',
        'ffmpeg.loaded': 'Motor pronto',
        'ffmpeg.error': 'Erro no motor',

        'recorder.sidebar.title': 'Configuração de captura',
        'recorder.sidebar.subtitle': 'Fontes e qualidade antes de começar',
        'recorder.sources.title': 'Fontes',
        'recorder.sources.hint': 'Áudio do sistema via compartilhamento de tela',
        'recorder.sources.mic.title': 'Microfone',
        'recorder.sources.mic.on': 'Incluído na mixagem',
        'recorder.sources.mic.off': 'Silenciado',
        'recorder.sources.cam.title': 'Câmera PIP',
        'recorder.sources.cam.on': 'PIP ativado',
        'recorder.sources.cam.off': 'Desativado',
        'recorder.sources.cam.position': 'Posição da câmera',
        'recorder.sources.cam.tooltip': 'Alternar posição da câmera',
        'recorder.sources.cam.pos.bottom-right': 'Inferior direita',
        'recorder.sources.cam.pos.bottom-left': 'Inferior esquerda',
        'recorder.sources.cam.pos.top-right': 'Superior direita',
        'recorder.sources.cam.pos.top-left': 'Superior esquerda',
        'recorder.quality.title': 'Qualidade',
        'recorder.quality.subtitle': 'FPS / Taxa de bits',
        'recorder.quality.standard.label': 'Padrão',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'Alta',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'Ultra',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'Personalizado',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'Inicializando...',
        'recorder.cta.start': 'Iniciar gravação',
        'recorder.tip': "Dica: escolha 'Entire Screen' para capturar áudio do sistema.",

        'preview.ready.title': 'Pronto para gravar',
        'preview.ready.desc': 'Escolha fontes e qualidade à esquerda e comece.',
        'preview.ready.controls': 'Os controles aparecerão aqui durante a gravação',
        'preview.badge.paused': 'PAUSADO',
        'preview.badge.rec': 'REC',
        'preview.resume': 'Retomar',
        'preview.pause': 'Pausar',
        'preview.changePosition': 'Mudar posição da câmera',
        'preview.stop': 'Parar',
        'preview.footer.paused': 'Gravação pausada. Clique em Retomar.',
        'preview.footer.recording': 'Gravando.',
        'preview.footer.tip': "Dica: selecione 'Entire Screen' para capturar o áudio do sistema.",

        'recorder.errors.empty': 'A gravação está vazia. Grave um pouco mais antes de parar.',
        'recorder.errors.permission': 'Permissão negada. Autorize o compartilhamento de tela.',
        'recorder.errors.startFailed': 'Falha ao iniciar a gravação',

        'editor.header.title': 'Editar e exportar',
        'editor.header.subtitle': 'Corte o clipe, ajuste e baixe.',
        'editor.header.recordNew': 'Gravar novamente',

        'editor.player.fullscreen.enter': 'Entrar em tela cheia',
        'editor.player.fullscreen.exit': 'Sair da tela cheia',
        'editor.player.total': 'Total',
        'editor.player.size': 'Tamanho',

        'editor.trim.title': 'Corte',
        'editor.trim.duration': 'Duração',
        'editor.trim.start': 'Início',
        'editor.trim.end': 'Fim',
        'editor.trim.preview': 'Pré-visualizar seleção',
        'editor.trim.reset': 'Redefinir corte',

        'editor.playback.durationUnknown': 'Não foi possível determinar a duração. Grave novamente.',
        'editor.playback.durationZero': 'Duração zero. Grave novamente.',
        'editor.playback.readError': 'Não foi possível ler a duração. Grave novamente.',
        'editor.playback.cannotExport': 'Não é possível exportar: gravação vazia ou corrompida.',
        'editor.playback.trimInvalid': 'Selecione um intervalo maior que zero.',

        'editor.export.title': 'Exportar',
        'editor.export.settings': 'Configurações',
        'editor.export.quickHint': 'Alta qualidade rápida: CRF 20 / 60fps / Original',
        'editor.export.quickButton': 'Aplicar preset',
        'editor.export.estimated': 'Tamanho estimado',
        'editor.export.quality': 'Qualidade',
        'editor.export.crf': 'CRF (18-23 recomendado)',
        'editor.export.crfHint': 'Quanto menor, mais qualidade e maior o arquivo.',
        'editor.export.resolution': 'Resolução',
        'editor.export.resolutionOriginal': 'Original',
        'editor.export.frameRate': 'Taxa de quadros',
        'editor.export.frameRateHint': 'Mais FPS é mais suave e mais lento para processar.',
        'editor.export.format': 'Formato',
        'editor.export.processing': 'Processando...',
        'editor.export.eta': 'ETA',
        'editor.export.etaEstimating': 'estimando...',
        'editor.export.ready': 'Exportação pronta',
        'editor.export.download': 'Baixar {{format}}',
        'editor.export.exportAnother': 'Exportar outra versão',
        'editor.export.exportTrimmed': 'Exportar trecho ({{label}})',
        'editor.export.exportFull': 'Exportar vídeo completo (sem corte)',
        'editor.export.playbackIssue': 'Grave novamente para corrigir a reprodução.',
        'editor.export.failed': 'Falha ao exportar. Verifique o console.',

        'quality.low.label': 'Baixa (Rápida)',
        'quality.low.description': 'Arquivo menor, processamento rápido',
        'quality.medium.label': 'Média (Equilibrada)',
        'quality.medium.description': 'Equilíbrio entre qualidade e tamanho',
        'quality.high.label': 'Alta (Qualidade)',
        'quality.high.description': 'Alta qualidade, arquivo maior',
        'quality.lossless.label': 'Sem perda (Máx)',
        'quality.lossless.description': 'Melhor qualidade, arquivo muito grande',
    },
    hi: {
        'common.language': 'भाषा',
        'common.processing': 'प्रोसेसिंग...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'क्लाइंट-साइड MP4 एक्सपोर्ट',
        'app.footer.line1': 'React, Tailwind और FFmpeg.wasm से निर्मित • yapweijun1996',
        'app.footer.line2': 'संस्करण 2.0 - पॉज़, ड्रैगेबल कैमरा और प्रीलोडेड एक्सपोर्ट',
        'app.processing.title': 'आपकी रिकॉर्डिंग पूरी हो रही है...',
        'app.processing.desc': 'प्लेबैक और ट्रिम को स्थिर रखने के लिए मेटाडेटा ठीक किया जा रहा है।',
        'app.error.empty': 'रिकॉर्डिंग खाली है। कुछ सेकंड और रिकॉर्ड कर के फिर प्रयास करें।',
        'app.error.invalidDuration': 'अमान्य रिकॉर्डिंग अवधि मिली।',
        'app.error.invalid': 'रिकॉर्डिंग सही नहीं लग रही। कृपया फिर से प्रयास करें।',
        'app.error.finalize': 'रिकॉर्डिंग प्रोसेस नहीं हो सकी। कृपया पुनः प्रयास करें।',

        'ffmpeg.idle': 'इंजन निष्क्रिय',
        'ffmpeg.loading': 'इंजन लोड हो रहा है...',
        'ffmpeg.loaded': 'इंजन तैयार',
        'ffmpeg.error': 'इंजन त्रुटि',

        'recorder.sidebar.title': 'कैप्चर सेटअप',
        'recorder.sidebar.subtitle': 'शुरू करने से पहले स्रोत और गुणवत्ता चुनें',
        'recorder.sources.title': 'स्रोत',
        'recorder.sources.hint': 'स्क्रीन शेयर से सिस्टम ऑडियो',
        'recorder.sources.mic.title': 'माइक्रोफोन',
        'recorder.sources.mic.on': 'मिक्स में शामिल',
        'recorder.sources.mic.off': 'म्यूट',
        'recorder.sources.cam.title': 'कैमरा PIP',
        'recorder.sources.cam.on': 'पिक्चर-इन-पिक्चर चालू',
        'recorder.sources.cam.off': 'बंद',
        'recorder.sources.cam.position': 'कैमरा स्थिति',
        'recorder.sources.cam.tooltip': 'कैमरा स्थिति बदलें',
        'recorder.sources.cam.pos.bottom-right': 'दायां नीचे',
        'recorder.sources.cam.pos.bottom-left': 'बायां नीचे',
        'recorder.sources.cam.pos.top-right': 'दायां ऊपर',
        'recorder.sources.cam.pos.top-left': 'बायां ऊपर',
        'recorder.quality.title': 'गुणवत्ता',
        'recorder.quality.subtitle': 'FPS / बिटरेट',
        'recorder.quality.standard.label': 'स्टैंडर्ड',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'हाई',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'अल्ट्रा',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'कस्टम',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'आरंभ हो रहा है...',
        'recorder.cta.start': 'रिकॉर्डिंग शुरू करें',
        'recorder.tip': "सुझाव: 'Entire Screen' चुनें ताकि सिस्टम ऑडियो रिकॉर्ड हो सके।",

        'preview.ready.title': 'रिकॉर्डिंग के लिए तैयार',
        'preview.ready.desc': 'बाएँ से स्रोत और गुणवत्ता चुनें, फिर रिकॉर्ड करें।',
        'preview.ready.controls': 'रिकॉर्डिंग के दौरान नियंत्रण यहाँ दिखेंगे',
        'preview.badge.paused': 'रुका',
        'preview.badge.rec': 'रिकॉर्ड',
        'preview.resume': 'फिर से शुरू',
        'preview.pause': 'रोकें',
        'preview.changePosition': 'कैमरा स्थिति बदलें',
        'preview.stop': 'रोकें',
        'preview.footer.paused': 'रिकॉर्डिंग रुकी है। जारी रखने के लिए क्लिक करें।',
        'preview.footer.recording': 'रिकॉर्डिंग जारी है।',
        'preview.footer.tip': "टिप: सिस्टम ऑडियो के लिए 'Entire Screen' चुनें।",

        'recorder.errors.empty': 'रिकॉर्डिंग खाली है। रोकने से पहले थोड़ा और रिकॉर्ड करें।',
        'recorder.errors.permission': 'अनुमति अस्वीकृत। स्क्रीन शेयर की अनुमति दें।',
        'recorder.errors.startFailed': 'रिकॉर्डिंग शुरू नहीं हो सकी',

        'editor.header.title': 'संपादित करें और एक्सपोर्ट करें',
        'editor.header.subtitle': 'क्लिप काटें, सेटिंग्स चुनें और डाउनलोड करें।',
        'editor.header.recordNew': 'फिर से रिकॉर्ड करें',

        'editor.player.fullscreen.enter': 'पूर्ण स्क्रीन',
        'editor.player.fullscreen.exit': 'पूर्ण स्क्रीन से बाहर',
        'editor.player.total': 'कुल',
        'editor.player.size': 'आकार',

        'editor.trim.title': 'कट',
        'editor.trim.duration': 'अवधि',
        'editor.trim.start': 'शुरुआत',
        'editor.trim.end': 'अंत',
        'editor.trim.preview': 'चयन पूर्वावलोकन',
        'editor.trim.reset': 'कट रीसेट',

        'editor.playback.durationUnknown': 'अवधि नहीं मिली। कृपया फिर से रिकॉर्ड करें।',
        'editor.playback.durationZero': 'अवधि 0 है। कृपया फिर से रिकॉर्ड करें।',
        'editor.playback.readError': 'अवधि नहीं पढ़ी जा सकी। कृपया फिर से रिकॉर्ड करें।',
        'editor.playback.cannotExport': 'एक्सपोर्ट संभव नहीं: रिकॉर्डिंग खाली या क्षतिग्रस्त है।',
        'editor.playback.trimInvalid': 'शून्य से बड़ा कट रेंज चुनें।',

        'editor.export.title': 'एक्सपोर्ट',
        'editor.export.settings': 'सेटिंग्स',
        'editor.export.quickHint': 'तेज़ उच्च गुणवत्ता: CRF 20 / 60fps / मूल रिज़ॉल्यूशन',
        'editor.export.quickButton': 'प्रिसेट लागू करें',
        'editor.export.estimated': 'अनुमानित आकार',
        'editor.export.quality': 'गुणवत्ता',
        'editor.export.crf': 'CRF (18-23 अनुशंसित)',
        'editor.export.crfHint': 'कम मान = अधिक गुणवत्ता, बड़ा फ़ाइल आकार।',
        'editor.export.resolution': 'रिज़ॉल्यूशन',
        'editor.export.resolutionOriginal': 'मूल',
        'editor.export.frameRate': 'फ़्रेम दर',
        'editor.export.frameRateHint': 'उच्च FPS अधिक स्मूद है पर धीमा प्रोसेस होता है।',
        'editor.export.format': 'फॉर्मेट',
        'editor.export.processing': 'प्रोसेसिंग...',
        'editor.export.eta': 'ETA',
        'editor.export.etaEstimating': 'अनुमान लगा रहे हैं...',
        'editor.export.ready': 'एक्सपोर्ट तैयार',
        'editor.export.download': '{{format}} डाउनलोड करें',
        'editor.export.exportAnother': 'एक और संस्करण एक्सपोर्ट करें',
        'editor.export.exportTrimmed': 'कट भाग एक्सपोर्ट करें ({{label}})',
        'editor.export.exportFull': 'पूरा वीडियो एक्सपोर्ट (कोई कट नहीं)',
        'editor.export.playbackIssue': 'प्लेबैक सुधारने के लिए फिर से रिकॉर्ड करें।',
        'editor.export.failed': 'एक्सपोर्ट विफल। कंसोल देखें।',

        'quality.low.label': 'निम्न (तेज़)',
        'quality.low.description': 'छोटी फ़ाइल, तेज़ प्रोसेस',
        'quality.medium.label': 'मध्यम (संतुलित)',
        'quality.medium.description': 'गुणवत्ता और आकार का संतुलन',
        'quality.high.label': 'उच्च (गुणवत्ता)',
        'quality.high.description': 'बेहतर गुणवत्ता, बड़ा आकार',
        'quality.lossless.label': 'लॉसलेस (अधिकतम)',
        'quality.lossless.description': 'सर्वोत्तम गुणवत्ता, बहुत बड़ा आकार',
    },
    id: {
        'common.language': 'Bahasa',
        'common.processing': 'Memproses...',

        'app.title': 'ScreenClip Pro',
        'app.tagline': 'Ekspor MP4 di sisi klien',
        'app.footer.line1': 'Dibuat dengan React, Tailwind & FFmpeg.wasm • yapweijun1996',
        'app.footer.line2': 'Versi 2.0 - Jeda, kamera bisa digeser & ekspor pramuat',
        'app.processing.title': 'Menyelesaikan rekaman...',
        'app.processing.desc': 'Kami merapikan metadata agar pemutaran dan trim stabil.',
        'app.error.empty': 'Rekaman kosong. Rekam beberapa detik lebih lama lalu coba lagi.',
        'app.error.invalidDuration': 'Durasi rekaman tidak valid terdeteksi.',
        'app.error.invalid': 'Rekaman tampak tidak valid. Coba lagi.',
        'app.error.finalize': 'Gagal memproses rekaman. Coba lagi.',

        'ffmpeg.idle': 'Mesin siaga',
        'ffmpeg.loading': 'Memuat mesin...',
        'ffmpeg.loaded': 'Mesin siap',
        'ffmpeg.error': 'Kesalahan mesin',

        'recorder.sidebar.title': 'Pengaturan rekam',
        'recorder.sidebar.subtitle': 'Pilih sumber & kualitas sebelum mulai',
        'recorder.sources.title': 'Sumber',
        'recorder.sources.hint': 'Audio sistem lewat berbagi layar',
        'recorder.sources.mic.title': 'Mikrofon',
        'recorder.sources.mic.on': 'Disertakan dalam campuran',
        'recorder.sources.mic.off': 'Dibisukan',
        'recorder.sources.cam.title': 'Kamera PIP',
        'recorder.sources.cam.on': 'PIP aktif',
        'recorder.sources.cam.off': 'Nonaktif',
        'recorder.sources.cam.position': 'Posisi kamera',
        'recorder.sources.cam.tooltip': 'Ubah posisi kamera',
        'recorder.sources.cam.pos.bottom-right': 'Kanan bawah',
        'recorder.sources.cam.pos.bottom-left': 'Kiri bawah',
        'recorder.sources.cam.pos.top-right': 'Kanan atas',
        'recorder.sources.cam.pos.top-left': 'Kiri atas',
        'recorder.quality.title': 'Kualitas',
        'recorder.quality.subtitle': 'FPS / Bitrate',
        'recorder.quality.standard.label': 'Standar',
        'recorder.quality.standard.detail': '30fps • ~5Mbps',
        'recorder.quality.high.label': 'Tinggi',
        'recorder.quality.high.detail': '30fps • ~10Mbps',
        'recorder.quality.ultra.label': 'Ultra',
        'recorder.quality.ultra.detail': '60fps • ~20Mbps',
        'recorder.quality.custom.label': 'Kustom',
        'recorder.quality.custom.detail': '{{fps}}fps • ~{{bitrate}}Mbps',
        'recorder.custom.fps': 'FPS',
        'recorder.custom.mbps': 'Mbps',
        'recorder.cta.initializing': 'Menginisialisasi...',
        'recorder.cta.start': 'Mulai rekam',
        'recorder.tip': "Tips: pilih 'Entire Screen' untuk menangkap audio sistem.",

        'preview.ready.title': 'Siap merekam',
        'preview.ready.desc': 'Pilih sumber dan kualitas di kiri, lalu mulai merekam.',
        'preview.ready.controls': 'Kontrol muncul di sini saat merekam',
        'preview.badge.paused': 'JEDA',
        'preview.badge.rec': 'REKAM',
        'preview.resume': 'Lanjutkan',
        'preview.pause': 'Jeda',
        'preview.changePosition': 'Ubah posisi kamera',
        'preview.stop': 'Berhenti',
        'preview.footer.paused': 'Rekaman dijeda. Klik lanjutkan.',
        'preview.footer.recording': 'Sedang merekam.',
        'preview.footer.tip': "Tips: pilih 'Entire Screen' untuk menangkap audio sistem.",

        'recorder.errors.empty': 'Rekaman kosong. Rekam sedikit lebih lama sebelum berhenti.',
        'recorder.errors.permission': 'Izin ditolak. Izinkan berbagi layar.',
        'recorder.errors.startFailed': 'Gagal memulai rekaman',

        'editor.header.title': 'Edit & ekspor',
        'editor.header.subtitle': 'Potong klip, atur ekspor, lalu unduh.',
        'editor.header.recordNew': 'Rekam lagi',

        'editor.player.fullscreen.enter': 'Masuk layar penuh',
        'editor.player.fullscreen.exit': 'Keluar layar penuh',
        'editor.player.total': 'Total',
        'editor.player.size': 'Ukuran',

        'editor.trim.title': 'Potong',
        'editor.trim.duration': 'Durasi',
        'editor.trim.start': 'Mulai',
        'editor.trim.end': 'Akhir',
        'editor.trim.preview': 'Pratinjau pilihan',
        'editor.trim.reset': 'Reset potong',

        'editor.playback.durationUnknown': 'Durasi tidak ditemukan. Silakan rekam lagi.',
        'editor.playback.durationZero': 'Durasi 0. Silakan rekam lagi.',
        'editor.playback.readError': 'Tidak bisa membaca durasi. Silakan rekam lagi.',
        'editor.playback.cannotExport': 'Tidak bisa ekspor: rekaman kosong atau rusak.',
        'editor.playback.trimInvalid': 'Pilih rentang potong lebih dari nol.',

        'editor.export.title': 'Ekspor',
        'editor.export.settings': 'Pengaturan',
        'editor.export.quickHint': 'Kualitas tinggi cepat: CRF 20 / 60fps / Original',
        'editor.export.quickButton': 'Terapkan preset',
        'editor.export.estimated': 'Perkiraan ukuran',
        'editor.export.quality': 'Kualitas',
        'editor.export.crf': 'CRF (18-23 disarankan)',
        'editor.export.crfHint': 'Semakin rendah semakin jernih, file lebih besar.',
        'editor.export.resolution': 'Resolusi',
        'editor.export.resolutionOriginal': 'Asli',
        'editor.export.frameRate': 'Frame rate',
        'editor.export.frameRateHint': 'FPS tinggi lebih mulus tapi lebih lama diproses.',
        'editor.export.format': 'Format',
        'editor.export.processing': 'Memproses...',
        'editor.export.eta': 'Perkiraan waktu',
        'editor.export.etaEstimating': 'menghitung...',
        'editor.export.ready': 'Ekspor siap',
        'editor.export.download': 'Unduh {{format}}',
        'editor.export.exportAnother': 'Ekspor versi lain',
        'editor.export.exportTrimmed': 'Ekspor potongan ({{label}})',
        'editor.export.exportFull': 'Ekspor video penuh (tanpa potong)',
        'editor.export.playbackIssue': 'Rekam lagi untuk memperbaiki pemutaran.',
        'editor.export.failed': 'Gagal mengekspor. Cek konsol.',

        'quality.low.label': 'Rendah (Cepat)',
        'quality.low.description': 'File kecil, proses cepat',
        'quality.medium.label': 'Sedang (Seimbang)',
        'quality.medium.description': 'Seimbang antara kualitas dan ukuran',
        'quality.high.label': 'Tinggi (Kualitas)',
        'quality.high.description': 'Kualitas tinggi, file lebih besar',
        'quality.lossless.label': 'Lossless (Maks)',
        'quality.lossless.description': 'Kualitas terbaik, ukuran sangat besar',
    },
};

interface I18nContextValue {
    language: LanguageCode;
    setLanguage: (code: LanguageCode) => void;
    t: (key: string, params?: Record<string, string | number>) => string;
    languages: LanguageOption[];
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

const getValue = (lang: LanguageCode, key: string): string | undefined => {
    const table = translations[lang];
    if (!table) return undefined;
    const direct = table[key];
    return direct;
};

const formatParams = (value: string, params?: Record<string, string | number>) => {
    if (!params) return value;
    return value.replace(/\{\{(.*?)\}\}/g, (_, rawKey) => {
        const paramKey = rawKey.trim();
        const val = params[paramKey];
        return val !== undefined ? String(val) : '';
    });
};

export const I18nProvider: React.FC<React.PropsWithChildren> = ({ children }) => {
    const [language, setLanguageState] = useState<LanguageCode>(DEFAULT_LANGUAGE);

    useEffect(() => {
        if (typeof window === 'undefined') return;
        const saved = window.localStorage.getItem(LANGUAGE_STORAGE_KEY) as LanguageCode | null;
        if (saved && translations[saved]) {
            setLanguageState(saved);
        }
    }, []);

    const setLanguage = (code: LanguageCode) => {
        if (!translations[code]) return;
        setLanguageState(code);
        if (typeof window !== 'undefined') {
            window.localStorage.setItem(LANGUAGE_STORAGE_KEY, code);
        }
    };

    const value = useMemo<I18nContextValue>(() => ({
        language,
        setLanguage,
        languages: LANGUAGE_OPTIONS,
        t: (key: string, params?: Record<string, string | number>) => {
            const raw = getValue(language, key) ?? getValue(DEFAULT_LANGUAGE, key) ?? key;
            return formatParams(raw, params);
        }
    }), [language]);

    return (
        <I18nContext.Provider value={value}>
            {children}
        </I18nContext.Provider>
    );
};

export const useI18n = () => {
    const ctx = useContext(I18nContext);
    if (!ctx) {
        throw new Error('useI18n must be used within I18nProvider');
    }
    return ctx;
};
